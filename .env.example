# Vulcan Environment Configuration
# =============================================================================
# Copy this file to .env and customize for your environment
#
# 12-Factor App Configuration:
# - PORT and HOST are the primitives (single source of truth)
# - URLs are derived automatically from these primitives
# - Override derived values only when necessary (e.g., behind a reverse proxy)
# =============================================================================

# =============================================================================
# CORE SETTINGS (Primary controls - set these)
# =============================================================================
# Port for the web server (used by Rails, Docker, and derived URLs)
PORT=3000

# Host for the application (used in derived URLs)
# Development: localhost
# Production: your domain or container hostname
HOST=localhost

# Scheme for URLs (http or https)
# Development: http
# Production behind TLS proxy: https
VULCAN_SCHEME=http

# =============================================================================
# DERIVED URLS (Auto-generated - override only if needed)
# =============================================================================
# These are automatically derived from PORT, HOST, and VULCAN_SCHEME
# Only set these explicitly if behind a reverse proxy with different external URL
#
# VULCAN_APP_URL=https://vulcan.example.com
# VULCAN_OIDC_REDIRECT_URI=https://vulcan.example.com/users/auth/oidc/callback

# =============================================================================
# DATABASE
# =============================================================================
# PostgreSQL port (for docker-compose)
DATABASE_PORT=5432

# Docker database credentials
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=vulcan_postgres_development

# For direct database connection (optional - database.yml handles this in dev)
# DATABASE_URL=postgres://postgres:postgres@localhost:5432/vulcan_development

# =============================================================================
# RAILS SECRETS
# =============================================================================
# Development: use these placeholder values
# Production: generate with ./setup-docker-secrets.sh or: openssl rand -hex 64
SECRET_KEY_BASE=development_secret_key_base_not_for_production_use
CIPHER_PASSWORD=development_cipher_password_not_for_production_use
CIPHER_SALT=development_cipher_salt_not_for_production_use

# =============================================================================
# AUTHENTICATION: Local Login
# =============================================================================
VULCAN_ENABLE_LOCAL_LOGIN=true
VULCAN_ENABLE_USER_REGISTRATION=true
VULCAN_SESSION_TIMEOUT=60

# Email confirmation (requires SMTP)
# VULCAN_ENABLE_EMAIL_CONFIRMATION=false

# =============================================================================
# AUTHENTICATION: OIDC (OpenID Connect)
# =============================================================================
# Enable OIDC authentication
VULCAN_ENABLE_OIDC=false

# OIDC Provider Configuration
# VULCAN_OIDC_PROVIDER_TITLE=OIDC Provider
# VULCAN_OIDC_ISSUER_URL=https://your-idp.example.com
# VULCAN_OIDC_CLIENT_ID=your-client-id
# VULCAN_OIDC_CLIENT_SECRET=your-client-secret

# OIDC redirect URI is derived from VULCAN_APP_URL automatically
# Override only if your IdP requires a different callback URL
# VULCAN_OIDC_REDIRECT_URI=https://vulcan.example.com/users/auth/oidc/callback

# =============================================================================
# AUTHENTICATION: LDAP
# =============================================================================
VULCAN_ENABLE_LDAP=false
# VULCAN_LDAP_HOST=ldap.example.com
# VULCAN_LDAP_PORT=389
# VULCAN_LDAP_TITLE=LDAP
# VULCAN_LDAP_ATTRIBUTE=uid
# VULCAN_LDAP_ENCRYPTION=plain
# VULCAN_LDAP_BASE=dc=example,dc=com
# VULCAN_LDAP_BIND_DN=cn=admin,dc=example,dc=com
# VULCAN_LDAP_ADMIN_PASS=ldap_password

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
VULCAN_CONTACT_EMAIL=admin@example.com
VULCAN_WELCOME_TEXT=Welcome to Vulcan

# App Banner (optional colored bar at top/bottom of page)
# Common use cases: "PUBLIC RELEASE", "UNCLASSIFIED", "DEVELOPMENT", "STAGING"
VULCAN_BANNER_ENABLED=false
VULCAN_BANNER_TEXT=
# Colors: Use Bootstrap variables (success, primary, danger, warning, info) or hex codes
VULCAN_BANNER_BACKGROUND_COLOR=success
VULCAN_BANNER_TEXT_COLOR=white

# Consent Banner (modal shown before authentication)
# Blocks access until user acknowledges terms of use
# Content supports markdown formatting
#
# HOW VERSIONS WORK:
# - Version is a tracking number you control (not a predefined template)
# - User acknowledges v1 → saves "vulcan-consent-v1" to localStorage
# - Next visit → checks for "vulcan-consent-v1", finds it, no modal
# - You update terms → increment to v2
# - Next visit → checks for "vulcan-consent-v2", doesn't find it, shows modal again
# - Increment version whenever you change the terms to force re-acknowledgment
#
VULCAN_CONSENT_BANNER_ENABLED=false
# Version number (increment when you change terms to re-prompt all users)
VULCAN_CONSENT_BANNER_VERSION=1
# Custom title (optional - defaults to "Terms of Use")
# VULCAN_CONSENT_BANNER_TITLE="System Access Warning"
# Title alignment: left, center, right (defaults to center)
# VULCAN_CONSENT_BANNER_TITLE_ALIGN=center
# Custom content (optional - uses default from config/vulcan.default.yml)
# VULCAN_CONSENT_BANNER_CONTENT="You are accessing a U.S. Government system...\n\n**Unauthorized access is prohibited.**"

# Project permissions
VULCAN_PROJECT_CREATE_PERMISSION_ENABLED=false

# =============================================================================
# EMAIL / SMTP (Optional)
# =============================================================================
VULCAN_ENABLE_SMTP=false
# VULCAN_SMTP_ADDRESS=smtp.gmail.com
# VULCAN_SMTP_PORT=587
# VULCAN_SMTP_DOMAIN=example.com
# VULCAN_SMTP_AUTHENTICATION=plain
# VULCAN_SMTP_TLS=false
# VULCAN_SMTP_ENABLE_STARTTLS_AUTO=true
# VULCAN_SMTP_SERVER_USERNAME=notifications@example.com
# VULCAN_SMTP_SERVER_PASSWORD=smtp_password

# =============================================================================
# SLACK INTEGRATION (Optional)
# =============================================================================
VULCAN_ENABLE_SLACK_COMMS=false
# VULCAN_SLACK_API_TOKEN=xoxb-your-token
# VULCAN_SLACK_CHANNEL_ID=C1234567890

# =============================================================================
# MONITORING (Optional)
# =============================================================================
PROMETHEUS_PORT=9394
# VULCAN_PROMETHEUS_BIND=0.0.0.0

# =============================================================================
# DOCKER / PRODUCTION OVERRIDES
# =============================================================================
# Image settings for docker-compose
# VULCAN_IMAGE=mitre/vulcan
# VULCAN_VERSION=latest

# =============================================================================
# NOTES
# =============================================================================
# Default admin login (after seeding): admin@example.com / 1234567ab!
# Seed the database: bundle exec rails db:seed
# Reset and reseed: bundle exec rails db:reset
