<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Welcome to Vulcan!
  </h1>
</section>
<% if current_user %>
  <% if current_user.has_role? :admin %>
    <div class="row">
        <div class="col-lg-12">
          <div class="card-box">
            <h4 class="m-t-0 header-title">Users Needing Roles</h4>
            <table id="requests-datatable" class="table table-striped table-bordered toggle-circle m-b-0" data-page-size="5">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Set Role</th>
                </tr>
              </thead>
              <tbody>
                <% User.all.each do |user| %>
                  <% if user.roles.blank? %>
                    <tr>
                      <td><%= user.email%></td>
                      <td>
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary dropdown-toggle waves-effect" data-toggle="dropdown" aria-expanded="false">  Action <span class="caret"></span> </button>
                            <div class="dropdown-menu">
                                <%= link_to 'Vendor', set_role_url(role: {:user_id => user.id, role: 'vendor'}), class: 'dropdown-item btn btn-success'%>
                                <%= link_to 'Sponsor', set_role_url(role: {:user_id => user.id, role: 'sponsor'}), class: 'dropdown-item btn btn-danger'%>
                                <%= link_to 'Admin', set_role_url(role: {:user_id => user.id, role: 'admin'}), class: 'dropdown-item btn btn-info'%>
                            </div>
                        </div>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </tbody>
              <tfoot>
                <tr class="active">
                    <td colspan="5">
                        <div class="text-right">
                            <ul class="pagination pagination-split justify-content-end footable-pagination m-t-10 m-b-0"></ul>
                        </div>
                    </td>
                </tr>
              </tfoot>
            </table>
          </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-6">
        <%= render 'components/vendor_form', vendor: Vendor.new %>
      </div>
      <div class="col-lg-6">
        <%= render 'components/sponsor_form', sponsor_agency: SponsorAgency.new %>
      </div>
    </div>
  <% end %>
<% end %>

<script>
  // $('[name="type"]').on("change", function() {
  //   if ($('[name="type"]').val() == 'Vendor') {
  //     $('#vendor_group').show();
  //     $('#sponsor_group').hide();
  //   } else if ($('[name="type"]').val() == 'Sponsor') {
  //     $('#vendor_group').hide();
  //     $('#sponsor_group').show();
  //   }
  // })
  
  // $('#new_request').submit(function(e){
  //   if ($('[name="type"]').val() == '') {
  //     alert("Please select a type of user");
  //     return false;
  //   }
  //   return true;
  //  });
</script>

<!-- /.content -->
