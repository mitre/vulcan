<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Welcome to Vulcan!
  </h1>
  <!-- <h1>
    TODO: Documentation for each role
  </h1> -->
</section>
<% if current_user %>
  <% if current_user.has_role? :admin %>
    <div class="row">
      <div class="col-lg-12">
        <div class="card-box">
          <h4 class="m-t-0 header-title">Users Needing Roles</h4>
          <div class="card-box">
            <div class="row">
              <div class="col-md-4">
                <h5>Email</h5>
              </div>
              <div class="col-md-5">
                <h5>Organization</h5>
              </div>
              <div class="col-md-3">
                <h5>Submit</h5>
              </div>
            </div>
            <% User.all.each do |user| %>
              <% if !user.has_role?(:vendor) && !user.has_role?(:sponsor) && !user.has_role?(:admin) %>
              <%= form_tag(set_role_url, method: "post", id: 'set_role_org', remote: true) do %>
                <div class="row">
                  <div class="col-md-4">
                    <%= hidden_field_tag 'user_id', user.id, id: 'user_id' %>
                    <%= user.email %>
                  </div>
                  <div class="col-md-5">
                    <%= select_tag('org', grouped_options_for_select(grouped_orgs), {class: 'form-control select2', id: 'org', include_blank: 'Select Organization'}) %>
                  </div>
                  <div class="col-md-3">
                    <%= submit_tag 'Submit', class: 'btn btn-success' %>
                  </div>
                <% end %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-6">
        <%= render 'components/vendor_form', vendor: Vendor.new %>
      </div>
      <div class="col-lg-6">
        <%= render 'components/sponsor_form', sponsor_agency: SponsorAgency.new %>
      </div>
    </div>
  <% end %>
<% end %>

<script>
  $('.select2').select2();

  $('.select2').on('change', function() {
    user_id = $(this).closest('tr').attr('value')

  })
  // $('[name="type"]').on("change", function() {
  //   if ($('[name="type"]').val() == 'Vendor') {
  //     $('#vendor_group').show();
  //     $('#sponsor_group').hide();
  //   } else if ($('[name="type"]').val() == 'Sponsor') {
  //     $('#vendor_group').hide();
  //     $('#sponsor_group').show();
  //   }
  // })

  // $('#new_request').submit(function(e){
  //   if ($('[name="type"]').val() == '') {
  //     alert("Please select a type of user");
  //     return false;
  //   }
  //   return true;
  //  });
</script>

<!-- /.content -->
